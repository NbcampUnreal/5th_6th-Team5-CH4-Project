# 숨바꼭질 (Hide and Seek)

> 꼭꼭 숨어라, 머리카락 보일라...
> 
> AI 속에 숨어든 인간을 찾아내는 멀티플레이어 공포 심리 추격전

## 📖 프로젝트 소개

<img width="1024" height="572" alt="T5Title" src="https://github.com/user-attachments/assets/a055500f-3bc3-4d92-878c-767434774567" />

숨바꼭질은 다수의 AI NPC 속에 숨어있는 도망자(플레이어)와, 이들을 찾아내야 하는 술래(플레이어) 간의 숨 막히는 심리전을 다룬 3D 멀티플레이어 게임이다.

초기 기획은 밝은 분위기의 캐주얼 게임이었으나, 개발 과정에서 술래 캐릭터에게 무기를 쥐여주고 얼굴에 짙은 그림자가 드리워진 모습에서 기괴한 공포감을 발견했다. 이 우연한 시각적 효과에 착안하여 프로젝트를 공포 스릴러 장르로 발전시켰다. 단순한 술래잡기를 넘어, Server Authority(서버 권한) 기반의 공정한 판정과 데이터 기반 설계를 통해 기술적 완성도를 확보했다.

* 개발 기간: 2025.12.08 ~ 2025.12.30
* 개발 인원: 5명
* 개발 환경: Unreal Engine 5.7, Visual Studio 2022, JetBrains Rider, Blueprint, GitHub

<br/>

## 🎮 게임 규칙

승리 조건: 제한 시간 60초 종료 시까지 생존하면 도망자 승리, 전원 검거 시 술래 승리

### 1. 술래 (Hunter)

* 플레이어 중 랜덤으로 1명이 선정됨.
* AI와 도망자 플레이어를 구별하여 공격해야 함.
* 패널티 시스템: 허공을 공격하거나 AI를 오인 사격할 경우 HP가 대폭 감소하며, 패널티 누적 시 패배 처리.

### 2. 도망자 (Hider)

* 술래를 제외한 나머지 플레이어들은 AI NPC와 동일한 외형으로 변신.
* AI처럼 자연스럽게 행동하거나 어두운 지형지물에 은폐해야 함.
* 총 2번의 생존 기회가 주어지며, 마지막까지 살아남으면 승리.

<br/>

## 🛠️ 핵심 구현 및 트러블슈팅

### 1. GameMode & Network Logic (담당: ISK)

게임의 전체적인 루프(대기-시작-종료)와 네트워크 동기화 담당.

#### 핵심 구현 사항

* Safe Start Logic (안전한 시작)
  네트워크 로딩 속도 차이로 인한 불공정한 시작을 방지하기 위해, GameInstance로 전달받은 총인원이 전원 접속했는지 서버가 검증한 후 카운트다운을 시작하도록 구현.

* Server Authority 판정 (서버 권한)
  해킹 및 판정 시비를 방지하기 위해 데미지와 패널티 계산을 전적으로 서버 권한으로 처리하고, 결과값만 클라이언트에 브로드캐스팅하는 구조 확립.

#### 트러블슈팅

* Q. 공격을 했는데 다른 사람 화면에서는 캐릭터가 멍하니 서 있음.
  
  * 원인: RPC(Server_Attack)는 서버에서 함수(로직)만 실행할 뿐, 시각적 요소(애니메이션)까지 자동으로 복제해주지 않음.
  * 해결: 로직(Logic)과 연출(Visual)을 분리하여, 서버가 로직 처리를 끝낸 후 Multicast를 통해 각 클라이언트에게 애니메이션 재생 명령을 별도로 내리도록 구조 개선.

* Q. 서버 타이머가 0이 되면 위젯이 바로 사라져야 하는데 안 사라짐.
  
  * 원인: 블루프린트 함수 내에서는 Delay 노드 사용이 불가능함.
  * 해결: 위젯 로직을 Event Graph의 Event Tick으로 옮기고, 0 이하일 때 Do Once 노드를 사용하여 자체적으로 종료 딜레이를 수행하도록 수정.

<br/>

### 2. Player Character & Interaction (담당: KNC)

플레이어의 조작감, 애니메이션 처리, 사물 상호작용 담당.

#### 핵심 구현 사항

* Enhanced Input을 통한 정확한 캐릭터 이동
  * Enhanced Input 시스템을 사용해 이동, 시점 회전, 점프, 공격 입력을 Input Action 단위로 분리하여 관리.

* 공격 상태 네트워크 동기화
  * 서버와 클라이언트 간 공격 상태와 애니메이션을 동기화하여 일관된 공격 동작을 유지.

* 역할 기반 캐릭터 분기 처리
  * PlayerState의 역할 정보에 따라 캐릭터 메쉬, 애니메이션, 무기 표시 여부를 동적으로 변경.
  
* 사운드가 술래에게서만 재생
  * 역할을 분리한 이후 술래인가 아닌가를 통하여 술래에게서만 사운드가 재상되도록 처리.
  * 그리고 피격과 빗나감에 따른 사운드 차이 구분.

#### 트러블슈팅

* 캐릭터의 라인트레이스가 엉뚱한 방향으로 튀는 문제
  * 원인: 틱을 기반으로 한 판정으로 인해 라인트레이스의 실행 타이밍이 제각각이였다.
  * 해결: 깔끔하게 캐릭터의 정면으로 라인트레이스가 나가도록 처리하여 일관성이 있게 만듬.

<br/>

### 3. AI Logic & NPC Behavior (담당: KGH)

도망자가 숨어들 수 있도록 자연스럽게 행동하는 군중 AI 구현.

#### 핵심 구현 사항

* **Behavior Tree를 활용한 군중 AI의 동적인 움직임 구현 :**
  * AI 캐릭터들이 단순 반복적인 움직임이 아닌, 무작위적인 행동 패턴을 보이도록 Behavior Tree를 구성하였습니다.
    이는 도망자가 군중 속에 자연스럽게 섞여들 수 있는 게임 환경을 조성하는 데 기여합니다.



* **Taken Damage Component를 이용한 통합 데미지 처리 시스템:**
  * AI 캐릭터의 체력 관리 및 데미지 처리를 통합적으로 수행하기 위해 `Taken Damage Component`를 개발했습니다. 이 컴포넌트는 모든 AI 캐릭터에게 재사용 가능한 형태로 데미지 수신, 체력 감소, 사망 처리 로직을 제공하며, AI의 상태 변화(예: 사망 시 행동 중단)를 효율적으로 관리합니다.

<br/>

### 4. Level Design & Atmosphere (담당: KTE)

공포스러운 분위기 조성을 위한 맵 배치와 라이팅, 내비게이션 설계 담당.

#### 핵심 구현 사항

* (내용 입력)

#### 트러블슈팅

* (내용 입력)

<br/>

### 5. UI Design & Sound (담당: LJH)

직관적인 정보 전달을 위한 위젯 구성과 몰입감을 높이는 사운드 연출 담당.

#### 핵심 구현 사항

* 카운트다운을 담당하는 WBP_CountDown,
체력을 표시하는 WBP_Healthbar,
역할에 따라 보여지는 WBP_Chaser, WBP_Runner,
그리고 사망 시 표시되는 WBP_Die.

#### 트러블슈팅

* HP 값이 서버에서만 변경되고 클라이언트로 복제되지 않아 UI가 갱신되지 않는 문제를, Replication과 OnRep를 통해 해결.
* 역할 값을 외부에서 직접 연결하는 대신, Switch 노드 내부에서 명확히 분기하도록 구조를 수정해 승리 판정 오류를 해결.

<br/>

## 👥 팀원 소개

* ISK: GameMode, Network Logic, Rule System
* KNC: Player Character
* KGH: AI Behavior, NPC Logic, Animation
* LJH: UI/UX
* KTE: Level Design

<br/>

## 📂 설치 및 실행

1. Releases 탭에서 최신 빌드 파일 다운로드.
2. 실행 파일(.exe) 실행.
3. Host: 세션 생성(Create Session)을 눌러 대기실 생성.
4. Client: 세션 찾기(Find Session)를 눌러 방에 입장.
5. 인원이 모두 모이면 Host가 시작(Start) 버튼 클릭.

---

Developed with Unreal Engine 5.7. Crafted by Team 5.
